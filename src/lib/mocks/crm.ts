import {
  ClienteCRM,
  MetricasCRM,
  SegmentoCRM,
} from '@/tipos/crm';

// FunÃ§Ã£o auxiliar para gerar cores de avatar
const coresAvatar = [
  '#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6',
  '#EC4899', '#14B8A6', '#F97316', '#6366F1', '#84CC16'
];

const getCorAvatar = (index: number) => coresAvatar[index % coresAvatar.length];

const getIniciais = (nome: string) => {
  const partes = nome.split(' ');
  if (partes.length === 1) return partes[0].substring(0, 2).toUpperCase();
  return (partes[0][0] + partes[partes.length - 1][0]).toUpperCase();
};

export const clientesCRMMockados: ClienteCRM[] = [
  {
    id: 'crm-1',
    nome: 'Carlos Mendes Silva',
    email: 'carlos.mendes@email.com',
    telefone: '(11) 98765-4321',
    whatsapp: '(11) 98765-4321',
    instagram: '@carlosmendes',
    empresa: 'Tech Solutions Ltda',
    cpfCnpj: '123.456.789-00',
    iniciais: getIniciais('Carlos Mendes Silva'),
    corAvatar: getCorAvatar(0),
    status: 'vip',
    tags: ['vip', 'b2b', 'recorrente', 'pagamento-rapido'],
    origem: 'indicacao',
    canalPreferido: 'whatsapp',
    endereco: {
      cep: '01310-100',
      rua: 'Av. Paulista',
      numero: '1000',
      complemento: 'Sala 501',
      bairro: 'Bela Vista',
      cidade: 'SÃ£o Paulo',
      estado: 'SP',
    },
    csat: 4.8,
    satisfacao: 'muito_satisfeito',
    ltv: 45000,
    totalCompras: 23,
    historicoCompras: [
      {
        id: 'comp-1',
        data: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
        valor: 2500,
        produto: 'Plano Premium',
        status: 'concluida',
      },
      {
        id: 'comp-2',
        data: new Date(Date.now() - 35 * 24 * 60 * 60 * 1000).toISOString(),
        valor: 2500,
        produto: 'Plano Premium',
        status: 'concluida',
      },
    ],
    clienteDesde: new Date(Date.now() - 365 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'Maria Silva',
    segmento: 'vip',
    emRisco: false,
  },
  {
    id: 'crm-2',
    nome: 'Ana Paula Costa',
    email: 'ana.costa@empresa.com',
    telefone: '(11) 99876-5432',
    whatsapp: '(11) 99876-5432',
    instagram: '@anapaulacosta',
    empresa: 'Boutique Elegance',
    iniciais: getIniciais('Ana Paula Costa'),
    corAvatar: getCorAvatar(1),
    status: 'cliente',
    tags: ['e-commerce', 'moda', 'alto-ticket'],
    origem: 'instagram',
    canalPreferido: 'instagram',
    endereco: {
      cep: '22640-100',
      rua: 'Rua Visconde de PirajÃ¡',
      numero: '550',
      bairro: 'Ipanema',
      cidade: 'Rio de Janeiro',
      estado: 'RJ',
    },
    csat: 4.5,
    satisfacao: 'muito_satisfeito',
    ltv: 18500,
    totalCompras: 12,
    historicoCompras: [
      {
        id: 'comp-3',
        data: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString(),
        valor: 850,
        produto: 'Vestido Premium',
        status: 'concluida',
      },
    ],
    clienteDesde: new Date(Date.now() - 180 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 5 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'JoÃ£o Oliveira',
    segmento: 'alto-valor',
    emRisco: false,
  },
  {
    id: 'crm-3',
    nome: 'Roberto Alves Pereira',
    email: 'roberto.alves@email.com',
    telefone: '(21) 98765-1234',
    whatsapp: '(21) 98765-1234',
    iniciais: getIniciais('Roberto Alves Pereira'),
    corAvatar: getCorAvatar(2),
    status: 'cliente',
    tags: ['fidelizado', 'satisfeito'],
    origem: 'site',
    canalPreferido: 'whatsapp',
    endereco: {
      cep: '20040-020',
      rua: 'Av. Rio Branco',
      numero: '185',
      bairro: 'Centro',
      cidade: 'Rio de Janeiro',
      estado: 'RJ',
    },
    csat: 4.2,
    satisfacao: 'satisfeito',
    ltv: 12000,
    totalCompras: 8,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 270 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 48 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 25 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'Maria Silva',
    segmento: 'regular',
    emRisco: false,
  },
  {
    id: 'crm-4',
    nome: 'Juliana Santos Oliveira',
    email: 'juliana@example.com',
    telefone: '(11) 97654-3210',
    whatsapp: '(11) 97654-3210',
    instagram: '@ju_santos',
    iniciais: getIniciais('Juliana Santos Oliveira'),
    corAvatar: getCorAvatar(3),
    status: 'em_risco',
    tags: ['insatisfeito', 'suporte-frequente'],
    origem: 'anuncio',
    canalPreferido: 'whatsapp',
    csat: 2.5,
    satisfacao: 'insatisfeito',
    ltv: 3200,
    totalCompras: 4,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 72 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'Ana Costa',
    segmento: 'risco',
    emRisco: true,
    motivoRisco: 'Sem compras hÃ¡ mais de 60 dias e baixa satisfaÃ§Ã£o',
  },
  {
    id: 'crm-5',
    nome: 'Pedro Henrique Lima',
    email: 'pedro.lima@email.com',
    telefone: '(85) 99123-4567',
    whatsapp: '(85) 99123-4567',
    empresa: 'Lima & Associados',
    iniciais: getIniciais('Pedro Henrique Lima'),
    corAvatar: getCorAvatar(4),
    status: 'vip',
    tags: ['vip', 'b2b', 'consultoria'],
    origem: 'indicacao',
    canalPreferido: 'email',
    endereco: {
      cep: '60160-230',
      rua: 'Av. Santos Dumont',
      numero: '2727',
      bairro: 'Aldeota',
      cidade: 'Fortaleza',
      estado: 'CE',
    },
    csat: 4.9,
    satisfacao: 'muito_satisfeito',
    ltv: 52000,
    totalCompras: 18,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 450 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'Carlos Oliveira',
    segmento: 'vip',
    emRisco: false,
  },
  {
    id: 'crm-6',
    nome: 'Mariana Ferreira',
    email: 'mari.ferreira@gmail.com',
    telefone: '(31) 98888-7777',
    whatsapp: '(31) 98888-7777',
    instagram: '@mariferreira',
    iniciais: getIniciais('Mariana Ferreira'),
    corAvatar: getCorAvatar(5),
    status: 'prospect',
    tags: ['prospect', 'interessado'],
    origem: 'instagram',
    canalPreferido: 'instagram',
    csat: 3.8,
    satisfacao: 'neutro',
    ltv: 450,
    totalCompras: 1,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 12 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 28 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'JoÃ£o Oliveira',
    segmento: 'novo',
    emRisco: false,
  },
  {
    id: 'crm-7',
    nome: 'Fernando Costa Rodrigues',
    email: 'fernando.costa@company.com',
    telefone: '(47) 99999-8888',
    whatsapp: '(47) 99999-8888',
    empresa: 'TechStart Brasil',
    cpfCnpj: '12.345.678/0001-90',
    iniciais: getIniciais('Fernando Costa Rodrigues'),
    corAvatar: getCorAvatar(6),
    status: 'cliente',
    tags: ['tech', 'saas', 'mensal'],
    origem: 'site',
    canalPreferido: 'email',
    endereco: {
      cep: '88015-100',
      rua: 'Rua Felipe Schmidt',
      numero: '515',
      bairro: 'Centro',
      cidade: 'FlorianÃ³polis',
      estado: 'SC',
    },
    csat: 4.4,
    satisfacao: 'satisfeito',
    ltv: 24000,
    totalCompras: 16,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 480 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 6 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 8 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'Maria Silva',
    segmento: 'regular',
    emRisco: false,
  },
  {
    id: 'crm-8',
    nome: 'Beatriz Almeida Santos',
    email: 'bia.almeida@email.com',
    telefone: '(71) 98765-4321',
    whatsapp: '(71) 98765-4321',
    instagram: '@bia_almeida',
    iniciais: getIniciais('Beatriz Almeida Santos'),
    corAvatar: getCorAvatar(7),
    status: 'lead',
    tags: ['lead', 'primeiro-contato'],
    origem: 'anuncio',
    canalPreferido: 'whatsapp',
    csat: 0,
    satisfacao: 'neutro',
    ltv: 0,
    totalCompras: 0,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 18 * 60 * 60 * 1000).toISOString(),
    responsavel: 'Ana Costa',
    segmento: 'novo',
    emRisco: false,
  },
  {
    id: 'crm-9',
    nome: 'Ricardo Mendes',
    email: 'ricardo.m@email.com',
    telefone: '(61) 99876-5432',
    whatsapp: '(61) 99876-5432',
    iniciais: getIniciais('Ricardo Mendes'),
    corAvatar: getCorAvatar(8),
    status: 'inativo',
    tags: ['inativo', 'ex-cliente'],
    origem: 'site',
    canalPreferido: 'email',
    csat: 3.2,
    satisfacao: 'neutro',
    ltv: 5400,
    totalCompras: 6,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 540 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 120 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 150 * 24 * 60 * 60 * 1000).toISOString(),
    segmento: 'inativo',
    emRisco: false,
  },
  {
    id: 'crm-10',
    nome: 'Camila Rodrigues Silva',
    email: 'camila.rodrigues@email.com',
    telefone: '(19) 98123-4567',
    whatsapp: '(19) 98123-4567',
    instagram: '@camilarodrigues',
    empresa: 'Studio Beauty Care',
    iniciais: getIniciais('Camila Rodrigues Silva'),
    corAvatar: getCorAvatar(9),
    status: 'cliente',
    tags: ['beleza', 'recorrente', 'satisfeito'],
    origem: 'indicacao',
    canalPreferido: 'whatsapp',
    endereco: {
      cep: '13010-111',
      rua: 'Av. Francisco GlicÃ©rio',
      numero: '935',
      bairro: 'Centro',
      cidade: 'Campinas',
      estado: 'SP',
    },
    csat: 4.6,
    satisfacao: 'muito_satisfeito',
    ltv: 8900,
    totalCompras: 11,
    historicoCompras: [],
    clienteDesde: new Date(Date.now() - 200 * 24 * 60 * 60 * 1000).toISOString(),
    ultimaInteracao: new Date(Date.now() - 3 * 60 * 60 * 1000).toISOString(),
    ultimaCompra: new Date(Date.now() - 12 * 24 * 60 * 60 * 1000).toISOString(),
    responsavel: 'JoÃ£o Oliveira',
    segmento: 'regular',
    emRisco: false,
  },
];

export const metricasCRMMockadas: MetricasCRM = {
  totalClientes: clientesCRMMockados.length,
  novosEsteMes: 5,
  ltvMedio: Math.round(
    clientesCRMMockados.reduce((acc, c) => acc + c.ltv, 0) / clientesCRMMockados.length
  ),
  csatMedio: Number(
    (clientesCRMMockados.reduce((acc, c) => acc + c.csat, 0) / clientesCRMMockados.length).toFixed(1)
  ),
  clientesVIP: clientesCRMMockados.filter(c => c.status === 'vip').length,
  clientesEmRisco: clientesCRMMockados.filter(c => c.emRisco).length,
  clientesInativos: clientesCRMMockados.filter(c => c.status === 'inativo').length,
  totalLTV: clientesCRMMockados.reduce((acc, c) => acc + c.ltv, 0),
};

export const segmentosCRMMockados: SegmentoCRM[] = [
  {
    id: 'seg-1',
    nome: 'Clientes VIP',
    descricao: 'Clientes de alto valor com LTV acima de R$ 40.000',
    filtros: {
      status: ['vip'],
      ltvMin: 40000,
    },
    totalClientes: clientesCRMMockados.filter(c => c.status === 'vip').length,
    cor: '#F59E0B',
    icone: 'â­',
  },
  {
    id: 'seg-2',
    nome: 'Em Risco',
    descricao: 'Clientes que nÃ£o compram hÃ¡ mais de 60 dias ou com baixa satisfaÃ§Ã£o',
    filtros: {
      status: ['em_risco'],
    },
    totalClientes: clientesCRMMockados.filter(c => c.emRisco).length,
    cor: '#EF4444',
    icone: 'âš ï¸',
  },
  {
    id: 'seg-3',
    nome: 'Novos Leads',
    descricao: 'Leads cadastrados nos Ãºltimos 30 dias',
    filtros: {
      status: ['lead', 'prospect'],
    },
    totalClientes: clientesCRMMockados.filter(c => c.status === 'lead' || c.status === 'prospect').length,
    cor: '#10B981',
    icone: 'ğŸ†•',
  },
  {
    id: 'seg-4',
    nome: 'Clientes Recorrentes',
    descricao: 'Clientes com mais de 10 compras',
    filtros: {
      totalCompras: {
        min: 10,
      },
    },
    totalClientes: clientesCRMMockados.filter(c => c.totalCompras >= 10).length,
    cor: '#8B5CF6',
    icone: 'ğŸ”„',
  },
  {
    id: 'seg-5',
    nome: 'B2B',
    descricao: 'Clientes empresariais',
    filtros: {
      tags: ['b2b'],
    },
    totalClientes: clientesCRMMockados.filter(c => c.tags.includes('b2b')).length,
    cor: '#3B82F6',
    icone: 'ğŸ¢',
  },
];
